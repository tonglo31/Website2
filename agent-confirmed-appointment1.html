<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./img/ico/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="./css/styles/styles.css">
    <link rel="stylesheet" href="./css/fontawesome-free-5.15.1-web/css/all.css">
    <link rel="stylesheet" href="./css/styles/search-property.css">
    <link rel="stylesheet" href="./css/styles/estate.css">
    <link rel="stylesheet" href="./css/styles/confirmed-appointment.css">
    <link rel="stylesheet" href="./css/styles/chatbox.css">
    <!-- data -->

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />
    <script src="./data/house.js"></script>
    <script src="./data/district.js"></script>
    <script src="./js/loadData.js"></script>
    <script src="./data/agent.js"></script>
    <script src="./data/appointment.js"></script>
    <!-- end of data -->
    <title>Dream House Property | Property Appointment</title>
  </head>
  <body>
    <!-- jquery && bootstrap-->
    <script type="text/javascript" src="./js/jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="./css/bootstrap-4.5.3-dist/js/bootstrap.js"></script>
    <script type="text/javascript" src="./css/bootstrap-4.5.3-dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="./css/bootstrap-4.5.3-dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="./js/comment.js"></script>
    <script src="./js/appointment-import.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <!-- end of jquery  -->
    <!-- navbar -->
    <span class="nav-btn" id="nav-btn">
      <i class="fas fa-bars"></i>
    </span>
    <header class="navbar">
      <span class="nav-close" id="nav-close">
        <i class="fas fa-times"></i>
      </span>
      <img class="navbar-logo" id="navbar-logo" src="./img/icon.jpg" alt="" />
      <nav>
        <ul class="nav-center">
          <li><a href="./property-update.html" class="nav-link">Edit Property</a></li>
          <li><a href="./agent-estate-comment.html" class="nav-link">Search property</a></li>
          <li><a href="./agent-profile.html" class="nav-link">Profile</a></li>
          <li><a href="./agent-appointment.html" class="nav-link">View Appointment</a></li>
        </ul>
      </nav>
      <nav>
        <ul>
          <li><a href="./index.html" class="nav-link" >Sign out</a></li>
        </ul>
      </nav>
    </header>
    <h3 id="title" class="header-title">Enjoy our services?</h3>
    <h4 class="header-title">Please take a moment to review your most recent services experienced.</h4>
    <button class="btn chatBtn chatToggle" id="chatToggle">Reply Message<i class="far fa-comment-alt" style="margin-left: 1rem"></i></button>
    <div class="chatbox">
      <div class="chatbox-title">
        <h4><i class="fas fa-comment-alt" style="margin-right: 0.5rem"></i>Reply Message</h4>
      </div>
      <div class="chat-container">
        <div class="reply-content">
          <span class="reply-icon" style="margin-right:0.5rem"><i class="fas fa-user"></i></span>
          <p>I want to change appointment time.
            <br/><span class="reply-time">10:55PM</span></p>
        </div>

      </div> 
      <div class="chatsend-group">
        <form class="chatform" id="replyChatForm" onsubmit="return false;">
            <textarea required id="chatMsg" class="form-input" rows="5" placeholder="leave your message here." style="width:400px"></textarea>
            <button class="btn" style="border-top-left-radius: 4px; border-top-right-radius: 4px; margin:0 auto; display: block;" id="agentSendMsg">Send Message</button>
        </form>
      </div>
    </div>
    <div class="estate">
      <div class="estate-info-container">
          <div class="big-container">
            <div class="img-container">
              <img src="./img/estate3.jpeg" alt="">
            </div>
            <div class="estate-details">
              <h5 class="title">Visited Estate</h5>
              <div class="estate-style">
                <p>Estate name: Kowloon Garden</p>
              </div>
              <div class="estate-style">
                  <p>District: Kowloon City</p>
              </div>
              <div class="estate-style">
                  <p>Visited Date: 2020-11-10</p>
              </div>
            </div>
            <div class="agent-info">
              <h5 class="title">Responsible Agent</h5>
              <div class="agent-info-container">
                  <div class="img-container">
                    <img src="./img/agent-profile.png" alt="">
                  </div>
                  <div class="agent-details">
                    <div class="agent-name">
                      <p>Agent name: Amelia Lai</p>
                    </div>
                    <div class="agent-email ">
                        <p>Agent email: Ameila@gmail.com</p>
                    </div>
                    <div class="agent-contact ">
                        <p>Contact phone: +852 21812345</p>
                    </div>
                  </div>
              </div>
          </div>
        </div>
      </div>
    </div>

    <div class="feedback hide">
      <!-- <p class="hide feedback-user">James Wong <span class="starRate"></span></p>

      <p class="feedback-date hide"></p>
      <p class="feedback-message hide"></p> -->
    </div>


    <div class="feedback-title">
      <h3>Users comment</h3>
    </div>
    <div class="feedback">
        <!-- <p class="hide feedback-user">James Wong <span class="starRate"></span></p>

        <p class="feedback-date hide"></p>
        <p class="feedback-message hide"></p> -->
      <p class="feedback-user">James Wong <span class="xd starRate1"><i class="fas fa-star" style="color:orange;font-weight:900"></i><i class="fas fa-star" style="color:orange;font-weight:900"></i><i class="fas fa-star" style="color:orange;font-weight:900"></i><i class="fas fa-star" style="color: orange; font-weight: 200"></i><i class="fas fa-star" style="color: orange; font-weight: 200"></i></span></p>
      <p class="qq feedback-date1">Reviewed on November 19 , 2020</p>
      <p class="feedback-message">333</p>

      <div class="showCommentField" style="cursor: pointer;">
        <p style="font-size: 0.75rem; text-align: center;">Comment<span id="iconField" style="padding-left:8px;font-size: 1rem;transition: all 0.35s linear;"><i class="fas fa-sort-down"></i></span></p>
      </div>

      <form id="responseComment" onsubmit="return false;">
        <div class="form-group">
          <textarea required rows="4" id="tt" placeholder="Respond to this review. Comments must adhere to Agent Guidelines." style="width: 100%;" type="form-input"></textarea>
          <button class="btn"  id="postComment" style="margin-left:70%; margin-top: 10px;">Post a comment</button>
        </div>
      </form>
      
    </div>


    <script src="./js/navbar.js"></script>
    <script>
      $(document).ready(function() {
        appendAgentInfo();
        $("#responseComment").hide();
        var x = 1;
        var strokeStar = `<i class="fas fa-star" style="color: orange; font-weight: 200"></i>`;
        var fillStar =   `<i class="fas fa-star" style="color:orange;font-weight:900"></i>`;
        var text = `Comment<span id="iconField" style="padding-left:8px;font-size: 1rem"><i class="fas fa-sort-down"></i></span>`;
        var text1 = `Comment<span id="iconField" style="padding-left:8px;font-size: 1rem"><i class="fas fa-sort-up"></i></span>`;
        $(".showCommentField").click(function(){
          if($(this).find("p").html().includes("fa-sort-down")){
            $(this).find("p").html(text1);
            $("#responseComment").toggle();
          }else{
            $(this).find("p").html(text);
            $("#responseComment").toggle();
          }
        });
        $("#postComment").click(function(){
          if(document.getElementById("responseComment").checkValidity()){
            var d = new Date();
              var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
              $(".showCommentField").after(`      <div style="text-align: left;margin: 30px;font-size: 12px;letter-spacing: 0.15rem;">
            <h4 style="letter-spacing: 0;">By Dream House Agent on<span class="dateMark"> ` + months[d.getMonth()] + " " + d.getDate() + " , " + d.getFullYear() + `</span></h4>
            <p style="text-indent: 2rem;">Reply: <span class="responseMessage">` + $("#tt").val() + `</span></p>
            </div>`);
            $("#responseComment").trigger("reset");
          }

      });
      $(".chatbox").hide();
        $("#agentSendMsg").click(function(){
          if(document.getElementById("replyChatForm").checkValidity()){
            var today = new Date();
            var currentHours = today.getHours();
            var currentMins = today.getMinutes();
            currentMins = ("0" + currentMins).slice(-2)
            currentHours = ("0" + currentHours).slice(-2);
            $(".chat-container").append(` <div class="reply-content user-reply">
          <p>`+ $("#chatMsg").val() + `
            <br/><span class="reply-time" style="margin-top: 1rem;">Reply on ` + currentHours + ":" + currentMins + `</span></p>
        </div>`)
            $("#chatMsg").val('');
            setTimeout(function() {
              $(".chat-container").animate({ scrollTop: $(".chat-container").prop("scrollHeight") });
              }, 500);
          }
        });

        $("#chatToggle").click(function(){
          if($(".chatbox").is(":visible")){
            $(".chatbox").fadeOut(200); 
          } else {
            $(".chatbox").fadeIn(200);
          }
        });
    });
    </script>
  </body>
</html>
